/*

  NoiseLoader Class jQuery Plugin definition
  
  Usage:
  

*/!function(e){var t='<div class="noise-loader-wrap">';t+='<div class="label">';t+='Decrypting conversation secret from <span class="username">Tom</span>.<br/>';t+="This can happen when you start a chat or if the user has gone offline and rejoined.";t+="</div>";t+='<div class="percent-progress">0</div>';t+='<div class="noise-loader"></div>';t+="</div>";NoiseLoader=function(n,r){this.$container=e(n);r=e.extend({percent:0,template:t},r);this.options=r;this.percent=r.percent;this.$container.prepend(this.options.template);this.$ele=this.$container.find(".noise-loader");this.initialize()};NoiseLoader.prototype.initialize=function(e){this.createBlocks();this.setupRandomOpacity()};NoiseLoader.prototype.createBlocks=function(){var e=this.$ele.height(),t=this.$ele.width(),n=4;for(var r=0;r<t;r+=n)for(var i=0;i<e;i+=n)this.$ele.append("<div></div>");this.$blocks=this.$ele.find("div")};NoiseLoader.prototype.setupRandomOpacity=function(){this.blockData=[];var t=this.blockData;this.$blocks.each(function(){t.push({$block:e(this),opacity:Math.random()-1,velocity:Math.random()-.5});e(this).css({opacity:t[t.length-1].opacity})})};NoiseLoader.prototype.updateRandomOpacity=function(){if(!this.blockData)return;var e=1;for(var t=0;t<this.blockData.length;t++){e=this.blockData[t].opacity+this.percent*2;this.blockData[t].$block.css({opacity:e})}};NoiseLoader.prototype.finishAnimation=function(){this.updateRandomOpacity();this.$ele.html('<div class="complete"></div>');this.$ele.addClass("complete");var t=this;setTimeout(function(){t.$ele.parents(".noise-loader-wrap").fadeOut("fast",function(){e(this).detach();t.selfDestruct()})},500)};NoiseLoader.prototype.setPercent=function(t){var n={duration:100,step:this.updateRandomOpacity};t==1&&(n.complete=this.finishAnimation);this.$ele.siblings(".percent-progress").text(Math.floor(t*100));e(this).stop().animate({percent:t},n)};NoiseLoader.prototype.selfDestruct=function(){this.$container.data("noiseLoader",null)};e.fn.noiseLoader=function(t,n){return this.each(function(){var r=e(this),i=r.data("noiseLoader");if(!i){i=new NoiseLoader(this,t);r.data("noiseLoader",i)}typeof t=="string"&&typeof i[t]=="function"&&i[t](n)})}}(window.jQuery);